<Window x:Class="BezierTool.BezierEditor"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:local="clr-namespace:BezierTool"
        mc:Ignorable="d"
        Title="贝塞尔曲线编辑器" Height="720" Width="1280"
        WindowStartupLocation="CenterScreen"
        TextOptions.TextFormattingMode="Display"
        TextOptions.TextRenderingMode="ClearType"
        TextOptions.TextHintingMode="Fixed"
        Loaded="OnWindowLoaded"
        KeyDown="OnWindowKeyDown"
        Closed="OnWindowClosed"
        Background="#FFF8F9FA">

    <Window.Resources>
        <!-- 颜色定义 -->
        <Color x:Key="PrimaryColor">#FF3F51B5</Color>
        <SolidColorBrush x:Key="PrimaryBrush" Color="#FF3F51B5" />
        <Color x:Key="PrimaryLightColor">#FF7986CB</Color>
        <SolidColorBrush x:Key="PrimaryLightBrush" Color="#FF7986CB" />
        <Color x:Key="PrimaryDarkColor">#FF303F9F</Color>
        <SolidColorBrush x:Key="PrimaryDarkBrush" Color="#FF303F9F" />
        <Color x:Key="AccentColor">#FFFF5722</Color>
        <SolidColorBrush x:Key="AccentBrush" Color="#FFFF5722" />
        <Color x:Key="AccentLightColor">#FFFF8A65</Color>
        <SolidColorBrush x:Key="AccentLightBrush" Color="#FFFF8A65" />
        <Color x:Key="SuccessColor">#FF4CAF50</Color>
        <SolidColorBrush x:Key="SuccessBrush" Color="#FF4CAF50" />
        <Color x:Key="SuccessDarkColor">#FF388E3C</Color>
        <SolidColorBrush x:Key="SuccessDarkBrush" Color="#FF388E3C" />
        <Color x:Key="BackgroundColor">#FFF8F9FA</Color>
        <SolidColorBrush x:Key="BackgroundBrush" Color="#FFF8F9FA" />
        <Color x:Key="SurfaceColor">#FFFFFFFF</Color>
        <SolidColorBrush x:Key="SurfaceBrush" Color="#FFFFFFFF" />
        <Color x:Key="BorderColor">#FFE0E0E0</Color>
        <SolidColorBrush x:Key="BorderBrush" Color="#FFE0E0E0" />
        <Color x:Key="TextPrimaryColor">#FF212121</Color>
        <SolidColorBrush x:Key="TextPrimaryBrush" Color="#FF212121" />
        <Color x:Key="TextSecondaryColor">#FF757575</Color>
        <SolidColorBrush x:Key="TextSecondaryBrush" Color="#FF757575" />

        <!-- 效果定义 -->
        <DropShadowEffect x:Key="DropShadowEffect"
                          ShadowDepth="1"
                          Opacity="0.1"
                          BlurRadius="4"
                          Color="#FF000000" />

        <DropShadowEffect x:Key="LightDropShadowEffect"
                          ShadowDepth="1"
                          Opacity="0.05"
                          BlurRadius="3"
                          Color="#FF000000" />

        <DropShadowEffect x:Key="MediumDropShadowEffect"
                          ShadowDepth="2"
                          Opacity="0.15"
                          BlurRadius="6"
                          Color="#FF000000" />

        <!-- 渐变画笔 -->
        <LinearGradientBrush x:Key="PrimaryGradientBrush" StartPoint="0,0" EndPoint="0,1">
            <GradientStop Color="{StaticResource PrimaryColor}" Offset="0" />
            <GradientStop Color="{StaticResource PrimaryDarkColor}" Offset="1" />
        </LinearGradientBrush>

        <LinearGradientBrush x:Key="AccentGradientBrush" StartPoint="0,0" EndPoint="0,1">
            <GradientStop Color="{StaticResource AccentColor}" Offset="0" />
            <GradientStop Color="#FFE64A19" Offset="1" />
        </LinearGradientBrush>

        <LinearGradientBrush x:Key="SuccessGradientBrush" StartPoint="0,0" EndPoint="0,1">
            <GradientStop Color="{StaticResource SuccessColor}" Offset="0" />
            <GradientStop Color="{StaticResource SuccessDarkColor}" Offset="1" />
        </LinearGradientBrush>

        <!-- 字体定义 -->
        <FontFamily x:Key="DefaultFont">Microsoft YaHei, SimHei, sans-serif</FontFamily>

        <!-- 按钮样式 -->
        <Style x:Key="ModernButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource PrimaryGradientBrush}" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="FontFamily" Value="{StaticResource DefaultFont}" />
            <Setter Property="FontSize" Value="13" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="Padding" Value="12,6" />
            <Setter Property="Margin" Value="4,2" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="Effect" Value="{StaticResource LightDropShadowEffect}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="4">
                            <ContentPresenter x:Name="contentPresenter"
                                              HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                              Margin="{TemplateBinding Padding}" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background"
                                        Value="{StaticResource PrimaryLightBrush}" />
                                <Setter TargetName="border" Property="RenderTransform">
                                    <Setter.Value>
                                        <ScaleTransform ScaleX="1.02" ScaleY="1.02" />
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background"
                                        Value="{StaticResource PrimaryDarkBrush}" />
                                <Setter TargetName="border" Property="RenderTransform">
                                    <Setter.Value>
                                        <ScaleTransform ScaleX="0.98" ScaleY="0.98" />
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.6" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- 复选框样式 -->
        <Style x:Key="ModernTitleCheckBoxStyle" TargetType="CheckBox">
            <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}" />
            <Setter Property="FontFamily" Value="{StaticResource DefaultFont}" />
            <Setter Property="FontSize" Value="13" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="Padding" Value="12,6" />
            <Setter Property="Margin" Value="4,2" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="CheckBox">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>

                            <!-- 复选框容器 -->
                            <Border x:Name="CheckBoxBorder"
                                    Grid.Column="0"
                                    Width="18"
                                    Height="18"
                                    Background="White"
                                    BorderBrush="{StaticResource BorderBrush}"
                                    BorderThickness="2"
                                    CornerRadius="3"
                                    Margin="0,0,8,0"
                                    VerticalAlignment="Center">
                                <Border.Effect>
                                    <DropShadowEffect ShadowDepth="1" Opacity="0.1" BlurRadius="2" />
                                </Border.Effect>

                                <!-- 勾选标记 -->
                                <Path x:Name="CheckMark"
                                      Data="M 3,8 L 7,12 L 13,4"
                                      Stroke="{StaticResource PrimaryBrush}"
                                      StrokeThickness="2"
                                      StrokeLineJoin="Round"
                                      StrokeStartLineCap="Round"
                                      StrokeEndLineCap="Round"
                                      Stretch="Uniform"
                                      Margin="1"
                                      Opacity="0"
                                      RenderTransformOrigin="0.5,0.5">
                                </Path>
                            </Border>

                            <!-- 内容展示 -->
                            <ContentPresenter x:Name="ContentPresenter"
                                              Grid.Column="1"
                                              VerticalAlignment="Center"
                                              Margin="2,0,0,0" />
                        </Grid>

                        <ControlTemplate.Triggers>
                            <!-- 鼠标悬停效果 -->
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="CheckBoxBorder" Property="BorderBrush"
                                        Value="{StaticResource PrimaryLightBrush}" />
                                <Setter TargetName="CheckBoxBorder" Property="Background"
                                        Value="#FFF5F7FA" />
                            </Trigger>

                            <!-- 选中状态 -->
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="CheckBoxBorder" Property="BorderBrush"
                                        Value="{StaticResource PrimaryBrush}" />
                                <Setter TargetName="CheckBoxBorder" Property="Background"
                                        Value="{StaticResource PrimaryBrush}" />
                                <Setter TargetName="CheckMark" Property="Opacity" Value="1" />
                                <Setter TargetName="CheckMark" Property="Stroke" Value="White" />

                            </Trigger>

                            <!-- 选中状态下的鼠标悬停 -->
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsChecked" Value="True" />
                                    <Condition Property="IsMouseOver" Value="True" />
                                </MultiTrigger.Conditions>
                                <Setter TargetName="CheckBoxBorder" Property="BorderBrush"
                                        Value="{StaticResource PrimaryDarkBrush}" />
                                <Setter TargetName="CheckBoxBorder" Property="Background"
                                        Value="{StaticResource PrimaryDarkBrush}" />
                            </MultiTrigger>

                            <!-- 禁用状态 -->
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.6" />
                                <Setter TargetName="CheckBoxBorder" Property="Background"
                                        Value="#FFF0F0F0" />
                                <Setter TargetName="CheckBoxBorder" Property="BorderBrush"
                                        Value="#FFCCCCCC" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="AccentButtonStyle" TargetType="Button" BasedOn="{StaticResource ModernButtonStyle}">
            <Setter Property="Background" Value="{StaticResource AccentGradientBrush}" />
        </Style>

        <Style x:Key="SuccessButtonStyle" TargetType="Button" BasedOn="{StaticResource ModernButtonStyle}">
            <Setter Property="Background" Value="{StaticResource SuccessGradientBrush}" />
            <Setter Property="FontWeight" Value="Bold" />
        </Style>

        <!-- 文本框样式 -->
        <Style x:Key="ModernTextBoxStyle" TargetType="TextBox">
            <Setter Property="Background" Value="White" />
            <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}" />
            <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Padding" Value="8,6" />
            <Setter Property="FontFamily" Value="{StaticResource DefaultFont}" />
            <Setter Property="FontSize" Value="13" />
            <Setter Property="Effect" Value="{StaticResource LightDropShadowEffect}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border x:Name="border"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="3">
                            <ScrollViewer x:Name="PART_ContentHost"
                                          Margin="{TemplateBinding Padding}"
                                          VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="BorderBrush"
                                        Value="{StaticResource PrimaryLightBrush}" />
                            </Trigger>
                            <Trigger Property="IsFocused" Value="True">
                                <Setter TargetName="border" Property="BorderBrush"
                                        Value="{StaticResource PrimaryBrush}" />
                                <Setter TargetName="border" Property="BorderThickness" Value="2" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- 列表框样式 -->
        <Style x:Key="ModernListBoxStyle" TargetType="ListBox">
            <Setter Property="Background" Value="White" />
            <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Disabled" />
            <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto" />
            <Setter Property="Effect" Value="{StaticResource LightDropShadowEffect}" />
            <Setter Property="ItemContainerStyle">
                <Setter.Value>
                    <Style TargetType="ListBoxItem">
                        <Setter Property="Background" Value="Transparent" />
                        <Setter Property="BorderThickness" Value="0" />
                        <Setter Property="Padding" Value="8,6" />
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="ListBoxItem">
                                    <Border x:Name="border"
                                            Background="{TemplateBinding Background}"
                                            BorderBrush="{TemplateBinding BorderBrush}"
                                            BorderThickness="{TemplateBinding BorderThickness}"
                                            CornerRadius="3">
                                        <ContentPresenter />
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter TargetName="border" Property="Background" Value="#FFF5F5F5" />
                                        </Trigger>
                                        <Trigger Property="IsSelected" Value="True">
                                            <Setter TargetName="border" Property="Background" Value="#FFE3F2FD" />
                                            <Setter TargetName="border" Property="BorderBrush"
                                                    Value="{StaticResource PrimaryBrush}" />
                                            <Setter TargetName="border" Property="BorderThickness" Value="1" />
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- DataGrid样式 -->
        <Style x:Key="ModernDataGridStyle" TargetType="DataGrid">
            <Setter Property="IsReadOnly" Value="True" />
            <Setter Property="Background" Value="White" />
            <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="RowBackground" Value="White" />
            <Setter Property="AlternatingRowBackground" Value="#FFF9F9F9" />
            <Setter Property="GridLinesVisibility" Value="None" />
            <Setter Property="HeadersVisibility" Value="Column" />
            <Setter Property="AutoGenerateColumns" Value="False" />
            <Setter Property="CanUserAddRows" Value="False" />
            <Setter Property="CanUserDeleteRows" Value="False" />
            <Setter Property="CanUserReorderColumns" Value="False" />
            <Setter Property="CanUserResizeRows" Value="False" />
            <Setter Property="CanUserSortColumns" Value="False" />
            <Setter Property="SelectionMode" Value="Single" />
            <Setter Property="SelectionUnit" Value="FullRow" />
            <Setter Property="FontFamily" Value="{StaticResource DefaultFont}" />
            <Setter Property="FontSize" Value="14" />
            <Setter Property="RowHeight" Value="22" />
            <Setter Property="ColumnHeaderHeight" Value="32" />
            <Setter Property="Effect" Value="{StaticResource LightDropShadowEffect}" />
            <Setter Property="VerticalContentAlignment" Value="Stretch" />
        </Style>

        <!-- 状态栏样式 -->
        <Style x:Key="ModernStatusBarStyle" TargetType="StatusBar">
            <Setter Property="Background" Value="{StaticResource PrimaryBrush}" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="FontFamily" Value="{StaticResource DefaultFont}" />
            <Setter Property="FontSize" Value="12" />
            <Setter Property="Height" Value="28" />
        </Style>

        <!-- 文本块样式 -->
        <Style x:Key="TitleTextStyle" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="{StaticResource DefaultFont}" />
            <Setter Property="FontSize" Value="16" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}" />
        </Style>

        <Style x:Key="LabelTextStyle" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="{StaticResource DefaultFont}" />
            <Setter Property="FontSize" Value="13" />
            <Setter Property="FontWeight" Value="Normal" />
            <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}" />
            <Setter Property="VerticalAlignment" Value="Center" />
        </Style>

        <!-- 点椭圆样式 -->
        <Style x:Key="PointEllipseStyle" TargetType="Ellipse">
            <Setter Property="Width" Value="12" />
            <Setter Property="Height" Value="12" />
            <Setter Property="Fill" Value="{StaticResource PrimaryBrush}" />
            <Setter Property="Stroke" Value="White" />
            <Setter Property="StrokeThickness" Value="2" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect ShadowDepth="2" Opacity="0.3" BlurRadius="4" />
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="SelectedPointEllipseStyle" TargetType="Ellipse" BasedOn="{StaticResource PointEllipseStyle}">
            <Setter Property="Fill" Value="{StaticResource AccentBrush}" />
            <Setter Property="Width" Value="14" />
            <Setter Property="Height" Value="14" />
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect ShadowDepth="3" Opacity="0.4" BlurRadius="6" Color="{StaticResource AccentColor}" />
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="ControlPointEllipseStyle" TargetType="Ellipse">
            <Setter Property="Width" Value="10" />
            <Setter Property="Height" Value="10" />
            <Setter Property="Fill" Value="{StaticResource SuccessBrush}" />
            <Setter Property="Stroke" Value="White" />
            <Setter Property="StrokeThickness" Value="1.5" />
            <Setter Property="Cursor" Value="SizeAll" />
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect ShadowDepth="1" Opacity="0.2" BlurRadius="3" />
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="ControlLineStyle" TargetType="Line">
            <Setter Property="Stroke" Value="#FF90A4AE" />
            <Setter Property="StrokeThickness" Value="1.5" />
            <Setter Property="StrokeDashArray" Value="4,2" />
            <Setter Property="Opacity" Value="0.7" />
        </Style>

        <!-- 复选框样式 -->
        <Style x:Key="ModernCheckBoxStyle" TargetType="CheckBox">
            <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}" />
            <Setter Property="FontFamily" Value="{StaticResource DefaultFont}" />
            <Setter Property="FontSize" Value="13" />
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="Margin" Value="0,0,0,8" />
        </Style>

        <!-- 边框样式 -->
        <Style x:Key="SectionBorderStyle" TargetType="Border">
            <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Background" Value="White" />
            <Setter Property="CornerRadius" Value="4" />
            <Setter Property="Margin" Value="8" />
            <Setter Property="Padding" Value="12" />
            <Setter Property="Effect" Value="{StaticResource DropShadowEffect}" />
        </Style>
    </Window.Resources>

    <DockPanel LastChildFill="True">
        <!-- 工具栏 -->
        <Border DockPanel.Dock="Top"
                Background="{StaticResource PrimaryBrush}"
                Padding="8,4"
                Effect="{StaticResource MediumDropShadowEffect}">
            <DockPanel LastChildFill="True">
                <!-- 左侧按钮组 -->
                <StackPanel DockPanel.Dock="Left" Orientation="Horizontal">
                    <Button Content="添加点"
                            Click="OnAddPointClick"
                            ToolTip="在画布中心添加新点"
                            Style="{StaticResource ModernButtonStyle}" />
                    <Button Content="删除选中点"
                            Click="OnDeletePointClick"
                            ToolTip="删除当前选中的点"
                            Style="{StaticResource AccentButtonStyle}" />
                    <Separator Margin="12,0" />
                    <Button Content="重置视图(拉伸)"
                            Click="OnResetViewStretchClick"
                            ToolTip="拉伸坐标轴适配画布大小"
                            Style="{StaticResource ModernButtonStyle}" />
                    <Button Content="重置视图(等比)"
                            Click="OnResetViewScaleClick"
                            ToolTip="等比缩放到最大可支持大小"
                            Style="{StaticResource ModernButtonStyle}" />
                </StackPanel>

                <!-- 右侧应用按钮 -->
                <StackPanel DockPanel.Dock="Right"
                            Orientation="Horizontal"
                            HorizontalAlignment="Right">
                    <Separator Margin="12,0" />
                    <Button x:Name="BtnApply"
                            Content="应用"
                            Click="OnApplyButtonClick"
                            ToolTip="应用当前贝塞尔曲线配置"
                            Style="{StaticResource SuccessButtonStyle}" />
                </StackPanel>
            </DockPanel>
        </Border>

        <!-- 状态栏 -->
        <StatusBar DockPanel.Dock="Bottom"
                   Style="{StaticResource ModernStatusBarStyle}">
            <StatusBarItem>
                <TextBlock x:Name="TxtStatus" Text="就绪" />
            </StatusBarItem>
            <Separator />
            <StatusBarItem>
                <TextBlock x:Name="TxtMousePosition" Text="X: 0, Y: 0" />
            </StatusBarItem>
            <Separator />
            <StatusBarItem>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="点数:" />
                    <TextBlock x:Name="TxtPointCount" Text="0" Margin="5,0,0,0" FontWeight="SemiBold" />
                </StackPanel>
            </StatusBarItem>
        </StatusBar>

        <Grid Background="{StaticResource BackgroundBrush}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="0.2*" MinWidth="280" />
                <!-- 采样区域 -->
                <ColumnDefinition Width="8" />
                <!-- 分割器1 -->
                <ColumnDefinition Width="*" />
                <!-- 主编辑区域 -->
                <ColumnDefinition Width="8" />
                <!-- 分割器2 -->
                <ColumnDefinition Width="0.2*" MinWidth="300" />
                <!-- 属性面板 -->
            </Grid.ColumnDefinitions>

            <!-- 采样区域 -->
            <Border Grid.Column="0"
                    Style="{StaticResource SectionBorderStyle}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <!-- 采样控制面板 -->
                    <Border Grid.Row="0"
                            Background="#FFF5F7FA"
                            CornerRadius="3"
                            Padding="8"
                            Margin="0,0,0,8">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="采样步长:"
                                       Style="{StaticResource LabelTextStyle}"
                                       Margin="0,0,8,0" />
                            <TextBox x:Name="TxtStepSize"
                                     Width="70"
                                     Text="1"
                                     Margin="0,0,16,0"
                                     Style="{StaticResource ModernTextBoxStyle}"
                                     TextChanged="OnStepSizeChanged" />
                            <TextBlock Text="X范围:"
                                       Style="{StaticResource LabelTextStyle}"
                                       Margin="0,0,8,0" />
                            <TextBlock x:Name="TxtXRange"
                                       Style="{StaticResource LabelTextStyle}"
                                       FontWeight="SemiBold" />
                        </StackPanel>
                    </Border>

                    <!-- 采样数据表格 -->
                    <DataGrid Grid.Row="1"
                              x:Name="SampleDataGrid"
                              Style="{StaticResource ModernDataGridStyle}">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="X值"
                                                Binding="{Binding X}"
                                                Width="*"
                                                FontFamily="{StaticResource DefaultFont}" />
                            <DataGridTextColumn Header="Y值"
                                                Binding="{Binding Y}"
                                                Width="*"
                                                FontFamily="{StaticResource DefaultFont}" />
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </Border>

            <!-- 采样区域分割器 -->
            <GridSplitter Grid.Column="1"
                          Width="8"
                          Background="#FFBDBDBD"
                          Cursor="SizeWE"
                          HorizontalAlignment="Center"
                          VerticalAlignment="Stretch"
                          ShowsPreview="True" />

            <!-- 主编辑区域 -->
            <Border Grid.Column="2"
                    Style="{StaticResource SectionBorderStyle}">
                <DockPanel LastChildFill="True">
                    <!-- 垂直缩放区域（右侧） -->
                    <Border x:Name="VerticalZoomArea" DockPanel.Dock="Right"
                            Width="16"
                            Background="Transparent"
                            Cursor="SizeNS"
                            MouseWheel="OnMainCanvasMouseWheel"
                            MouseEnter="OnZoomAreaMouseEnter"
                            MouseLeave="OnZoomAreaMouseLeave">
                        <Border.Style>
                            <Style TargetType="Border">
                                <Setter Property="Background" Value="Transparent" />
                                <Setter Property="BorderBrush" Value="Transparent" />
                                <Setter Property="BorderThickness" Value="0" />
                                <Setter Property="Margin" Value="0,0,0,16" />
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="#10000000" />
                                        <Setter Property="BorderBrush" Value="#20000000" />
                                        <Setter Property="BorderThickness" Value="0,0,1,0" />
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Border.Style>

                        <!-- 缩放提示图标 -->
                        <Grid VerticalAlignment="Center" HorizontalAlignment="Center">
                            <StackPanel Orientation="Vertical" Margin="0,0,0,0">
                                <!-- 向上箭头 -->
                                <Path Data="M 0,4 L 4,0 L 8,4"
                                      Stroke="{StaticResource PrimaryBrush}"
                                      StrokeThickness="1.5"
                                      StrokeLineJoin="Round"
                                      Margin="0,0,0,2"
                                      Width="8" Height="4"
                                      HorizontalAlignment="Center" />

                                <!-- 鼠标滚轮图标 -->
                                <Ellipse Width="10" Height="10"
                                         Stroke="{StaticResource PrimaryBrush}"
                                         StrokeThickness="1"
                                         Fill="Transparent"
                                         Margin="0,4,0,4"
                                         HorizontalAlignment="Center" />

                                <!-- 向下箭头 -->
                                <Path Data="M 0,0 L 4,4 L 8,0"
                                      Stroke="{StaticResource PrimaryBrush}"
                                      StrokeThickness="1.5"
                                      StrokeLineJoin="Round"
                                      Margin="0,2,0,0"
                                      Width="8" Height="4"
                                      HorizontalAlignment="Center" />

                                <!-- 提示文本 -->
                                <TextBlock Text="滚轮缩放"
                                           FontSize="9"
                                           Foreground="{StaticResource TextSecondaryBrush}"
                                           HorizontalAlignment="Center"
                                           TextAlignment="Center"
                                           Margin="0,8,0,0"
                                           Width="40"
                                           TextWrapping="Wrap"
                                           RenderTransformOrigin="0.5,0.5">
                                    <TextBlock.RenderTransform>
                                        <RotateTransform Angle="-90" />
                                    </TextBlock.RenderTransform>
                                </TextBlock>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- 水平缩放区域（底部） -->
                    <Border x:Name="HorizontalZoomArea" DockPanel.Dock="Bottom"
                            Height="16"
                            Background="Transparent"
                            Cursor="SizeWE"
                            MouseWheel="OnMainCanvasMouseWheel"
                            MouseEnter="OnZoomAreaMouseEnter"
                            MouseLeave="OnZoomAreaMouseLeave">
                        <Border.Style>
                            <Style TargetType="Border">
                                <Setter Property="Background" Value="Transparent" />
                                <Setter Property="BorderBrush" Value="Transparent" />
                                <Setter Property="BorderThickness" Value="0" />
                                <Setter Property="Margin" Value="16,0,0,0" />
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="#10000000" />
                                        <Setter Property="BorderBrush" Value="#20000000" />
                                        <Setter Property="BorderThickness" Value="0,1,0,0" />
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Border.Style>

                        <!-- 缩放提示图标 -->
                        <Grid VerticalAlignment="Center" HorizontalAlignment="Center">
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,0">
                                <!-- 向左箭头 -->
                                <Path Data="M 4,0 L 0,4 L 4,8"
                                      Stroke="{StaticResource PrimaryBrush}"
                                      StrokeThickness="1.5"
                                      StrokeLineJoin="Round"
                                      Margin="0,0,2,0"
                                      Width="4" Height="8"
                                      VerticalAlignment="Center" />

                                <!-- 鼠标滚轮图标 -->
                                <Ellipse Width="10" Height="10"
                                         Stroke="{StaticResource PrimaryBrush}"
                                         StrokeThickness="1"
                                         Fill="Transparent"
                                         Margin="4,0,4,0"
                                         VerticalAlignment="Center" />

                                <!-- 向右箭头 -->
                                <Path Data="M 0,0 L 4,4 L 0,8"
                                      Stroke="{StaticResource PrimaryBrush}"
                                      StrokeThickness="1.5"
                                      StrokeLineJoin="Round"
                                      Margin="2,0,0,0"
                                      Width="4" Height="8"
                                      VerticalAlignment="Center" />

                                <!-- 提示文本 -->
                                <TextBlock Text="滚轮缩放"
                                           FontSize="9"
                                           Foreground="{StaticResource TextSecondaryBrush}"
                                           VerticalAlignment="Center"
                                           TextAlignment="Center"
                                           Margin="8,0,0,0"
                                           Width="40" />
                            </StackPanel>
                        </Grid>
                    </Border>
                    <Canvas x:Name="MainCanvas" Background="White"
                            MouseLeftButtonDown="OnMainCanvasMouseDown"
                            MouseMove="OnMainCanvasMouseMove"
                            MouseLeftButtonUp="OnMainCanvasMouseUp"
                            MouseWheel="OnMainCanvasMouseWheel"
                            MouseRightButtonDown="OnCanvasRightMouseDown"
                            SizeChanged="OnMainCanvasSizeChanged">
                        <Canvas.Clip>
                            <RectangleGeometry Rect="0,0,1,1" />
                        </Canvas.Clip>
                        <!-- 坐标轴和网格层 -->
                        <Canvas x:Name="AxisCanvas" IsHitTestVisible="False">
                            <!-- 坐标轴和网格将在这里动态绘制 -->
                        </Canvas>

                        <!-- 贝塞尔曲线层 -->
                        <Canvas x:Name="BezierCanvas" Background="Transparent">
                            <!-- 贝塞尔曲线 -->
                            <Path x:Name="BezierPath"
                                  Stroke="{StaticResource PrimaryBrush}"
                                  StrokeThickness="3"
                                  Fill="Transparent"
                                  StrokeLineJoin="Round"
                                  StrokeStartLineCap="Round"
                                  StrokeEndLineCap="Round" />

                            <!-- 控制线和控制点将在这里动态添加 -->
                        </Canvas>
                    </Canvas>
                </DockPanel>
            </Border>

            <!-- 属性面板分割器 -->
            <GridSplitter Grid.Column="3"
                          Width="8"
                          Background="#FFBDBDBD"
                          Cursor="SizeWE"
                          HorizontalAlignment="Center"
                          VerticalAlignment="Stretch"
                          ShowsPreview="True" />

            <!-- 属性面板 -->
            <Border Grid.Column="4"
                    Style="{StaticResource SectionBorderStyle}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <!-- 标题 -->
                    <Border Grid.Row="0"
                            Background="{StaticResource PrimaryBrush}"
                            CornerRadius="3"
                            Padding="12,8"
                            Margin="0,0,0,12">
                        <TextBlock Text="点属性"
                                   Style="{StaticResource TitleTextStyle}"
                                   Foreground="White"
                                   HorizontalAlignment="Center" />
                    </Border>

                    <!-- 点列表 -->
                    <Border Grid.Row="1"
                            BorderBrush="{StaticResource BorderBrush}"
                            BorderThickness="1"
                            CornerRadius="3"
                            Margin="0,0,0,12">
                        <ListBox x:Name="LstPoints"
                                 Style="{StaticResource ModernListBoxStyle}"
                                 SelectionChanged="OnPointSelectionChanged">
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <Grid Margin="2">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="20" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Ellipse Grid.Column="0" Width="12"
                                                 Height="12"
                                                 Fill="{StaticResource PrimaryBrush}"
                                                 Margin="0,0,8,0"
                                                 Stroke="White"
                                                 StrokeThickness="1" />
                                        <Grid Grid.Column="1">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="0.5*" />
                                                <ColumnDefinition Width="0.5*" />
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Grid.Column="0" Text="{Binding Position.X}"
                                                       VerticalAlignment="Center"
                                                       FontFamily="{StaticResource DefaultFont}"
                                                       Foreground="{StaticResource TextPrimaryBrush}" />
                                            <TextBlock Grid.Column="1" Text="{Binding Position.Y}"
                                                       VerticalAlignment="Center"
                                                       FontFamily="{StaticResource DefaultFont}"
                                                       Foreground="{StaticResource TextPrimaryBrush}" />
                                        </Grid>
                                    </Grid>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                    </Border>

                    <!-- 选中点属性 -->
                    <Border Grid.Row="2"
                            BorderBrush="{StaticResource BorderBrush}"
                            BorderThickness="1"
                            CornerRadius="3"
                            Padding="12"
                            Background="#FFF9F9F9">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>

                            <!-- 标题 -->
                            <TextBlock Grid.Row="0"
                                       Grid.ColumnSpan="2"
                                       Text="选中点属性"
                                       Style="{StaticResource LabelTextStyle}"
                                       FontWeight="SemiBold"
                                       Margin="0,0,0,12"
                                       Foreground="{StaticResource PrimaryBrush}" />

                            <!-- X坐标 -->
                            <TextBlock Grid.Row="1"
                                       Grid.Column="0"
                                       Text="X坐标:"
                                       Style="{StaticResource LabelTextStyle}"
                                       Margin="0,0,8,8" />
                            <TextBox x:Name="TxtPointX"
                                     Grid.Row="1"
                                     Grid.Column="1"
                                     Margin="0,0,0,8"
                                     Style="{StaticResource ModernTextBoxStyle}"
                                     TextChanged="OnPointPropertyChanged" />

                            <!-- Y坐标 -->
                            <TextBlock Grid.Row="2"
                                       Grid.Column="0"
                                       Text="Y坐标:"
                                       Style="{StaticResource LabelTextStyle}"
                                       Margin="0,0,8,8" />
                            <TextBox x:Name="TxtPointY"
                                     Grid.Row="2"
                                     Grid.Column="1"
                                     Margin="0,0,0,8"
                                     Style="{StaticResource ModernTextBoxStyle}"
                                     TextChanged="OnPointPropertyChanged" />

                            <!-- 对称控制杆 -->
                            <CheckBox x:Name="ChkSymmetric"
                                      Grid.Row="3"
                                      Grid.ColumnSpan="2"
                                      Content="对称控制杆"
                                      Style="{StaticResource ModernCheckBoxStyle}"
                                      Checked="OnSymmetricChanged"
                                      Unchecked="OnSymmetricChanged" />

                            <!-- 左控制杆 -->
                            <TextBlock Grid.Row="4"
                                       Grid.Column="0"
                                       Text="左控制杆:"
                                       Style="{StaticResource LabelTextStyle}"
                                       Margin="0,0,8,8" />
                            <Grid Grid.Row="4"
                                  Grid.Column="1"
                                  Margin="0,0,0,8">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="X:"
                                           Style="{StaticResource LabelTextStyle}"
                                           Margin="0,0,4,0" />
                                <TextBox Grid.Column="1" x:Name="TxtLeftControlX"
                                         Margin="0,0,12,0"
                                         Style="{StaticResource ModernTextBoxStyle}"
                                         TextChanged="OnControlPropertyChanged" />
                                <TextBlock Grid.Column="2" Text="Y:"
                                           Style="{StaticResource LabelTextStyle}"
                                           Margin="0,0,4,0" />
                                <TextBox Grid.Column="3" x:Name="TxtLeftControlY"
                                         Style="{StaticResource ModernTextBoxStyle}"
                                         TextChanged="OnControlPropertyChanged" />
                            </Grid>

                            <!-- 右控制杆 -->
                            <TextBlock Grid.Row="5"
                                       Grid.Column="0"
                                       Text="右控制杆:"
                                       Style="{StaticResource LabelTextStyle}"
                                       Margin="0,0,8,0" />
                            <Grid Grid.Row="5"
                                  Grid.Column="1">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="X:"
                                           Style="{StaticResource LabelTextStyle}"
                                           Margin="0,0,4,0" />
                                <TextBox Grid.Column="1" x:Name="TxtRightControlX"
                                         Margin="0,0,12,0"
                                         Style="{StaticResource ModernTextBoxStyle}"
                                         TextChanged="OnControlPropertyChanged" />
                                <TextBlock Grid.Column="2" Text="Y:"
                                           Style="{StaticResource LabelTextStyle}"
                                           Margin="0,0,4,0" />
                                <TextBox Grid.Column="3" x:Name="TxtRightControlY"
                                         Style="{StaticResource ModernTextBoxStyle}"
                                         TextChanged="OnControlPropertyChanged" />
                            </Grid>
                        </Grid>
                    </Border>
                </Grid>
            </Border>
        </Grid>
    </DockPanel>
</Window>